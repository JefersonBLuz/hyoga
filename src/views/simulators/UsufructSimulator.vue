<script lang="ts">
import MInputNumber from '@/components/MInputNumber.vue';
import MainAdsenseBottom from '@/components/MainAdsenseBottom.vue';
import { calculateUsufruct } from '@/utils/UsufructSimulatorFunctions';

export default {
    name: 'UsufructSimulator',
    components: { MainAdsenseBottom, MInputNumber },
    head() {
        return {
            title: 'Simulador de Usufruto ou Fruição',
            meta: [
                {
                    name: 'description',
                    content: 'Calcule quanto tempo você conseguirá usufruir de uma renda pré-determinada, com base em um patrimônio acumulado. Simulador usado para planejamento financeiro e aposentadoria.'
                }
            ]
        };
    },
    data() {
        return {
            equity: 0,
            optionsProfitability: [
                { name: 'a.m.', code: 'a.m.' },
                { name: 'a.a.', code: 'a.a.' }
            ],
            profitability: {
                value: 0,
                option: { name: 'a.m.', code: 'a.m.' }
            },
            monthlyWithdrawal: 0,
            resultSimulation: null as any
        };
    },
    methods: {
        calculate() {
            this.resultSimulation = calculateUsufruct(this.profitability, this.equity, this.monthlyWithdrawal);
        },
        clearFields() {
            this.equity = 0;
            this.profitability = {
                value: 0,
                option: { name: 'a.m.', code: 'a.m.' }
            };
            this.monthlyWithdrawal = 0;
            this.resultSimulation = 0;
        }
    }
};
</script>

<template>
    <div className="card">
        <h4>Simulador de Usufruto ou Fruição</h4>
        <p>O resultado mostrará quanto tempo você conseguirá usufruir de uma renda pré-determinada, com base em um patrimônio acumulado.</p>
        <div className="p-fluid formgrid grid">
            <div className="field col-12 md:col-4">
                <label>Patrimônio</label>
                <InputGroup>
                    <InputGroupAddon>R$</InputGroupAddon>
                    <MInputNumber v-model="equity" />
                </InputGroup>
            </div>
            <div className="field col-12 md:col-4">
                <label>Rentabilidade <i class="pi pi-question-circle" v-tooltip.focus.top="'Taxa de rentabilidade onde o patrimônio está aplicado'" tabindex="1"></i></label>
                <InputGroup>
                    <MInputNumber v-model="profitability.value" />
                    <InputGroupAddon>%</InputGroupAddon>
                    <Dropdown v-model="profitability.option" :options="optionsProfitability" optionLabel="name" class="w-7rem" />
                </InputGroup>
            </div>
            <div className="field col-12 md:col-4">
                <label>Retirada mensal <i class="pi pi-question-circle" v-tooltip.focus.top="'Quanto você deseja retirar por mês'" tabindex="2"></i></label>
                <InputGroup>
                    <InputGroupAddon>R$</InputGroupAddon>
                    <MInputNumber v-model="monthlyWithdrawal" />
                </InputGroup>
            </div>
            <div className="field col-12 mt-3">
                <div class="flex flex-wrap sm:flex-nowrap" style="max-width: 500px">
                    <Button label="Calcular" @click="calculate" />
                    <Button label="Limpar" @click="clearFields" link />
                </div>
            </div>
        </div>
        <div className="col-12 mt-5 result" v-if="resultSimulation">
            <h4>Resultado</h4>
            <div class="grid mt-3">
                <div class="col-12 md:col-6 md:col-offset-3 xl:col-4 xl:col-offset-4">
                    <Fieldset legend="Tempo até zerar o patrimônio">
                        <h5 class="positive">{{ resultSimulation }}</h5>
                    </Fieldset>
                </div>
            </div>
        </div>
    </div>
    <MainAdsenseBottom />
</template>

<style scoped lang="scss">
.result {
    .grid {
        h5 {
            text-align: center;
            margin-bottom: 0;
            font-size: 24px;

            &.positive {
                color: var(--green-700);
            }
        }
    }
}
</style>
